function e(e,t,o,n){Object.defineProperty(e,t,{get:o,set:n,enumerable:!0,configurable:!0})}var t={};e(t,"symbols",()=>n),e(t,"request",()=>u),e(t,"metroError",()=>d),e(t,"response",()=>l),e(t,"client",()=>i),e(t,"url",()=>function e(...t){let s="https://localhost/";for(let e of t)if("string"==typeof e||e instanceof String)s=new URL(e,s);else if(e instanceof URL)s=new URL(e);else if(e&&"object"==typeof e)for(let n in e)if("search"==n)"function"==typeof e.search?s.search=e.search(s.search,s):s.search=new URLSearchParams(e.search);else if("searchParams"==n)!function(e,t){if("function"==typeof t){let o=t(e.searchParams,e);o&&(e.searchParams=o)}else(t=new URLSearchParams(t)).forEach((t,o)=>{e.searchParams.append(o,t)})}(s,e.searchParams);else{if(!["hash","host","hostname","href","origin","password","pathname","port","protocol","username"].includes(n))throw d("metro.url: unknown url parameter "+o+"url/unknown-param-name/",n);if("function"==typeof e[n])s[n]=e[n](s[n],s);else if("string"==typeof e[n]||e[n]instanceof String||"number"==typeof e[n]||e[n]instanceof Number||"boolean"==typeof e[n]||e[n]instanceof Boolean)s[n]=""+e[n];else if("object"==typeof e[n]&&e[n].toString)s[n]=e[n].toString();else throw d("metro.url: unsupported value for "+n+" "+o+"url/unsupported-param-value/",t[n])}else throw d("metro.url: unsupported option value "+o+"url/unsupported-option-value/",e);return Object.freeze(s),new Proxy(s,{get(t,o,s){switch(o){case n.isProxy:return!0;case n.source:return t;case"with":return function(...o){return e(t,...o)};case"toString":case"toJSON":return function(){return t[o]()}}return t[o]}})}),e(t,"formdata",()=>function e(...t){var o=new FormData;for(let e of t)if(e instanceof FormData)for(let t of e.entries())o.append(t[0],t[1]);else if(e&&"object"==typeof e)for(let t of Object.entries(e))if(Array.isArray(t[1]))for(let e of t[1])o.append(t[0],e);else o.append(t[0],t[1]);else throw new d("metro.formdata: unknown option type, only FormData or Object supported",e);return Object.freeze(o),new Proxy(o,{get:(t,o,s)=>{switch(o){case n.isProxy:return!0;case n.source:return t;case"with":return function(...o){return e(t,...o)};case"toString":case"toJSON":return function(){return t[o]()}}return t[o]}})}),e(t,"trace",()=>y);const o="https://metro.muze.nl/details/",n={isProxy:Symbol("isProxy"),source:Symbol("source")};class s{#e={url:"undefined"!=typeof window?window.location:"https://localhost"};#t=["get","post","put","delete","patch","head","options","query"];static tracers={};constructor(...e){for(let t of(this.#e.verbs=this.#t,e))if("string"==typeof t||t instanceof String)this.#e.url=""+t;else if(t instanceof s)Object.assign(this.#e,t.#e);else if(t instanceof Function)this.#r([t]);else if(t&&"object"==typeof t)for(let e in t)"middlewares"==e?this.#r(t[e]):"function"==typeof t[e]?this.#e[e]=t[e](this.#e[e],this.#e):this.#e[e]=t[e];for(let e of(this.#e.verbs||(this.#e.verbs=this.#t),this.#e.verbs))this[e]=async function(...t){return this.#o(u(this.#e.url,...t,{method:e.toUpperCase()}))};Object.freeze(this)}#r(e){"function"==typeof e&&(e=[e]);let t=e.findIndex(e=>"function"!=typeof e);if(t>=0)throw d("metro.client: middlewares must be a function or an array of functions "+o+"client/invalid-middlewares-value/",e[t]);Array.isArray(this.#e.middlewares)||(this.#e.middlewares=[]),this.#e.middlewares=this.#e.middlewares.concat(e)}#o(e){if(!e.url)throw d("metro.client."+r.method.toLowerCase()+": Missing url parameter "+o+"client/missing-url-param/",e);let t=this.#e?.middlewares?.slice()||[];return this.#e,async function e(o){let i;let a=Object.values(s.tracers);for(let e of a)e.request&&e.request.call(e,o);let c=t.pop();for(let t of(c?i=await c(o,e):(o[n.isProxy]&&(o=o[n.source]),i=l(await fetch(o))),a))t.response&&t.response.call(t,i);return i}(u(this.#e,e))}with(...e){return new s(this,...e)}}function i(...e){return new s(...e)}function a(e,t){return new Proxy(t.body,{get(t,o,s){switch(o){case n.isProxy:return!0;case n.source:return e;case"toString":return function(){return""+e}}return"object"==typeof e&&o in e?"function"==typeof e[o]?function(...t){return e[o].apply(e,t)}:e[o]:o in t&&"toString"!=o?"function"==typeof t[o]?function(...e){return t[o].apply(t,e)}:t[o]:void 0},has:(t,o)=>o in e,ownKeys:t=>Reflect.ownKeys(e),getOwnPropertyDescriptor:(t,o)=>Object.getOwnPropertyDescriptor(e,o)})}function c(e,t){let o=t||{};for(let n of(!o.url&&t.url&&(o.url=t.url),["method","headers","body","mode","credentials","cache","redirect","referrer","referrerPolicy","integrity","keepalive","signal","priority","url"]))"function"==typeof e[n]?o[n]=e[n](o[n],o):void 0!==e[n]&&("url"==n?o.url=new URL(e.url,o.url):o[n]=e[n]);return o}function u(...e){let t={url:"undefined"!=typeof window?window.location:"https://localhost/",duplex:"half"};for(let o of e)"string"==typeof o?t.url=new URL(o,t.url):o instanceof Request?Object.assign(t,c(o,t)):o instanceof URL?t.url=new URL(o,t.url):o&&"object"==typeof o&&Object.assign(t,c(o,t));let o=t.body;!o||"object"!=typeof o||o instanceof String||o instanceof ReadableStream||o instanceof Blob||o instanceof ArrayBuffer||o instanceof DataView||o instanceof FormData||o instanceof URLSearchParams||"undefined"!=typeof TypedArray&&o instanceof TypedArray||(t.body=JSON.stringify(o));let s=new Request(t.url,t);return Object.freeze(s),new Proxy(s,{get(e,t,s){switch(t){case n.source:return e;case n.isProxy:return!0;case"with":return function(...t){return u(e,...t)};case"toString":case"toJSON":case"blob":case"text":case"json":return function(){return e[t].apply(e)};case"body":if(o||(o=e.body),o){if(o[n.isProxy])return o;return a(o,e)}}return e[t]}})}function f(e,t){let o=t||{};for(let n of(!o.url&&t.url&&(o.url=t.url),["status","statusText","headers","body","url","type","redirected"]))"function"==typeof e[n]?o[n]=e[n](o[n],o):void 0!==e[n]&&("url"==n?o.url=new URL(e.url,o.url||"https://localhost/"):o[n]=e[n]);return o}function l(...e){let t={};for(let o of e)"string"==typeof o?t.body=o:o instanceof Response?Object.assign(t,f(o,t)):o&&"object"==typeof o&&(o instanceof FormData||o instanceof Blob||o instanceof ArrayBuffer||o instanceof DataView||o instanceof ReadableStream||o instanceof URLSearchParams||o instanceof String||"undefined"!=typeof TypedArray&&o instanceof TypedArray?t.body=o:Object.assign(t,f(o,t)));let o=new Response(t.body,t);return Object.freeze(o),new Proxy(o,{get(e,o,s){switch(o){case n.isProxy:return!0;case n.source:return e;case"with":return function(...t){return l(e,...t)};case"body":if(!t.body)return a("",e);if(t.body[n.isProxy])return t.body;return a(t.body,e);case"ok":return e.status>=200&&e.status<400;case"headers":return e.headers;default:if(o in t&&"toString"!=o)return t[o];if(o in e&&"toString"!=o){if("function"==typeof e[o])return function(...t){return e[o].apply(e,t)};return e[o]}}}})}const p={error:(e,...t)=>{console.error("Ⓜ️  "+e,...t)},info:(e,...t)=>{console.info("Ⓜ️  "+e,...t)},group:e=>{console.group("Ⓜ️  "+e)},groupEnd:e=>{console.groupEnd("Ⓜ️  "+e)}};function d(e,...t){return p.error(e,...t),Error(e,...t)}const y={add(e,t){s.tracers[e]=t},delete(e){delete s.tracers[e]},clear(){s.tracers={}},group(){let e=0;return{request:t=>{e++,p.group(e),p.info(t.url)},response:t=>{p.info(t.body),p.groupEnd(e),e--}}}};window.metro=t;
//# sourceMappingURL=browser.js.map
